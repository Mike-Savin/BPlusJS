<html>
	<head>
		<script src="../CommonJavascript/jquery-1.6.js" type="text/javascript"></script>
		<script src="../CommonJavascript/common.js" type="text/javascript"></script>
		<script src="bplus.js" type="text/javascript"></script>
		<script type="text/javascript">
			var bplusTree = new com.anvesaka.bplus.BPlusTree({
				order:6,
				mergeThreshold:2
			});
			
			function getRandomInt(min, max) {
			    return Math.floor(Math.random() * (max - min + 1)) + min;
			}
			
			var val;
			var key;
			var start;
			var end;
			var range;
			
			val = 0;
			for (var i=0; i<100; i++) {
				$.log($.LOG_INFO, "Adding "+val);
				bplusTree.insert(val, val);
				$.log($.LOG_INFO, bplusTree.toString());
				val+=getRandomInt(1, 10);
			}
			range = bplusTree.range(0, 1000);
			range.forEach(function(item) {
				$.log($.LOG_INFO, "Removing "+item.key);
				bplusTree.remove(item.key);
				$.log($.LOG_INFO, bplusTree.toString());
			});
			range = bplusTree.range(0, 1000);

			var bplusTree = new com.anvesaka.bplus.BPlusTree({
				order:100,
				mergeThreshold:40
			});

			start = new Date().getTime();
			for (var i=0; i<500000; i++) {
				val = getRandomInt(0, 1000000);
				key = "key"+val; 
				val = "val"+val; 
			}			
			end = new Date().getTime();	
			$.log($.LOG_INFO, "Random key generation: "+(end-start));
			
			start = new Date().getTime();
			for (var i=0; i<500000; i++) {
				val = getRandomInt(0, 1000000);
				bplusTree.insert("key"+val, "val"+val);
			}
			end = new Date().getTime();	
			$.log($.LOG_INFO, "Insertion: "+(end-start));
			
			range = bplusTree.range(100000, 200000);

			start = new Date().getTime();
			for (var i=0; i<500000; i++) {
				val = getRandomInt(0, 1000000);
				bplusTree.remove("key"+val);
			}
			end = new Date().getTime();	
			$.log($.LOG_INFO, "Removal: "+(end-start));

			range = bplusTree.range(100000, 200000);

			start = new Date().getTime();
			for (var i=0; i<500000; i++) {
				val = getRandomInt(0, 1000000);
				bplusTree.insert("key"+val, "val"+val);
			}
			end = new Date().getTime();	
			$.log($.LOG_INFO, "Insertion: "+(end-start));

			range = bplusTree.range(100000, 200000);
		</script>
	</head>
	<body>
	</body>
</html>